<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Band Planning Tool</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Login/Registration Modal -->
    <div id="authModal" class="modal active">
        <div class="modal-content auth-modal">
            <h1>üéµ Band Planning Tool</h1>
            <p class="subtitle">Organisiere deine Bandproben effizient</p>

            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Anmelden</button>
                <button class="auth-tab" data-tab="register">Registrieren</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label for="loginUsername">Benutzername</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Passwort</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">Anmelden</button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="registerCode">Registrierungscode</label>
                    <input type="text" id="registerCode" placeholder="Code eingeben" required>
                    <small style="color: var(--color-text-secondary); font-size: 0.875rem;">Bitte gib den g√ºltigen
                        Registrierungscode ein</small>
                </div>
                <div class="form-group">
                    <label for="registerName">Name</label>
                    <input type="text" id="registerName" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">E-Mail</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerUsername">Benutzername</label>
                    <input type="text" id="registerUsername" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Passwort</label>
                    <input type="password" id="registerPassword" required>
                </div>
                <div class="form-group">
                    <label for="registerPasswordConfirm">Passwort best√§tigen</label>
                    <input type="password" id="registerPasswordConfirm" required>
                </div>
                <button type="submit" class="btn btn-primary">Registrieren</button>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1 class="logo">üéµ Band Planning</h1>
                <div class="header-actions">
                    <button id="settingsBtn" class="btn btn-secondary" style="display: none;">‚öôÔ∏è Settings</button>
                    <span id="currentUserName" class="user-name"></span>
                    <button id="logoutBtn" class="btn btn-secondary">Abmelden</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <button class="nav-item active" data-view="dashboard">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Dashboard</span>
            </button>
            <button class="nav-item" data-view="bands">
                <span class="nav-icon">üé∏</span>
                <span class="nav-label">Meine Bands</span>
            </button>
            <button class="nav-item" data-view="events">
                <span class="nav-icon">üé§</span>
                <span class="nav-label">Auftritte</span>
            </button>
            <button class="nav-item" data-view="rehearsals">
                <span class="nav-icon">üìÖ</span>
                <span class="nav-label">Probetermine</span>
            </button>
            <button class="nav-item" data-view="statistics">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">Statistiken</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view active">
                <div class="view-header">
                    <h2>Dashboard</h2>
                </div>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-icon">üé∏</div>
                        <div class="card-content">
                            <h3>Meine Bands</h3>
                            <p class="card-stat" id="bandCount">0</p>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon">üìÖ</div>
                        <div class="card-content">
                            <h3>Offene Abstimmungen</h3>
                            <p class="card-stat" id="pendingVotes">0</p>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon">‚úÖ</div>
                        <div class="card-content">
                            <h3>Geplante Proben</h3>
                            <p class="card-stat" id="confirmedRehearsals">0</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>Aktuelle Abstimmungen</h3>
                    <div id="recentVotes" class="rehearsal-list"></div>
                </div>
            </div>

            <!-- Bands View -->
            <div id="bandsView" class="view">
                <div class="view-header">
                    <h2>Meine Bands</h2>
                    <div class="header-buttons">
                        <button id="joinBandBtn" class="btn btn-secondary"
                            style="margin-right: 10px; margin-top: 20px;">Band
                            beitreten</button>
                        <button id="createBandBtn" class="btn btn-primary">+ Neue Band erstellen</button>
                    </div>
                </div>
                <div id="bandsList" class="bands-grid"></div>
            </div>

            <!-- Events View -->
            <div id="eventsView" class="view">
                <div class="view-header">
                    <h2>Auftritte</h2>
                    <div class="view-controls">
                        <select id="eventBandFilter" class="form-select">
                            <option value="">Alle Bands</option>
                        </select>
                        <button id="createEventBtn" class="btn btn-primary">+ Neuer Auftritt</button>
                    </div>
                </div>
                <div id="eventsList" class="events-list"></div>
            </div>

            <!-- Rehearsals View -->
            <div id="rehearsalsView" class="view">
                <div class="view-header">
                    <h2>Probetermine</h2>
                    <div class="view-controls">
                        <select id="bandFilter" class="form-select">
                            <option value="">Alle Bands</option>
                        </select>
                        <button id="createRehearsalBtn" class="btn btn-primary">+ Neuer Probetermin</button>
                    </div>
                </div>
                <div id="rehearsalsList" class="rehearsal-list"></div>
            </div>

            <!-- Statistics View -->
            <div id="statisticsView" class="view">
                <div class="view-header">
                    <h2>Statistiken</h2>
                    <select id="statsRehearsalSelect" class="form-select">
                        <option value="">Probetermin ausw√§hlen</option>
                    </select>
                </div>
                <div id="statisticsContent" class="statistics-content">
                    <div class="empty-state">
                        <div class="empty-icon">üìä</div>
                        <p>W√§hle einen Probetermin aus, um die Statistiken zu sehen</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="settings-tab-btn active" data-tab="locations">Standorte</button>
                    <button class="settings-tab-btn" data-tab="bands">Bandmanagement</button>
                </div>

                <!-- Locations Tab -->
                <div id="locationsSettingsTab" class="settings-tab-content active">
                    <div class="section">
                        <h3>Neuen Standort hinzuf√ºgen</h3>
                        <form id="createLocationForm" class="inline-form">
                            <div class="form-group">
                                <input type="text" id="newLocationName" placeholder="Name (z.B. Proberaum A)" required>
                            </div>
                            <div class="form-group">
                                <input type="text" id="newLocationAddress" placeholder="Adresse (Optional)">
                            </div>
                            <button type="submit" class="btn btn-primary">Hinzuf√ºgen</button>
                        </form>
                    </div>
                    <div class="section">
                        <h3>Vorhandene Standorte</h3>
                        <div id="locationsList" class="locations-list"></div>
                    </div>
                </div>

                <!-- Bands Management Tab -->
                <div id="bandsSettingsTab" class="settings-tab-content">
                    <div class="section">
                        <h3>Alle Bands</h3>
                        <div id="allBandsList" class="bands-management-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Band Modal -->
    <div id="createBandModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Neue Band erstellen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="createBandForm">
                <div class="form-group">
                    <label for="bandName">Bandname</label>
                    <input type="text" id="bandName" required>
                </div>
                <div class="form-group">
                    <label for="bandDescription">Beschreibung</label>
                    <textarea id="bandDescription" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Band erstellen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Band Details Modal -->
    <div id="bandDetailsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="bandDetailsName"></h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="band-details-tabs">
                    <button class="tab-btn active" data-tab="members">Mitglieder</button>
                    <button class="tab-btn" data-tab="settings">Einstellungen</button>
                </div>

                <!-- Members Tab -->
                <div id="membersTab" class="tab-content active">
                    <div class="section">
                        <div class="section-header">
                            <h3>Bandmitglieder</h3>
                            <button id="addMemberBtn" class="btn btn-primary btn-sm">+ Mitglied hinzuf√ºgen</button>
                        </div>
                        <div id="membersList" class="members-list"></div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="settingsTab" class="tab-content">
                    <div class="section">
                        <h3>Band-Einstellungen</h3>
                        <div class="settings-actions">
                            <button id="deleteBandBtn" class="btn btn-danger">Band l√∂schen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Mitglied hinzuf√ºgen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="addMemberForm">
                <div class="form-group">
                    <label for="memberUsername">Benutzername</label>
                    <input type="text" id="memberUsername" required>
                </div>
                <div class="form-group">
                    <label for="memberRole">Rolle</label>
                    <select id="memberRole" required>
                        <option value="member">Mitglied</option>
                        <option value="co-leader">Co-Leiter</option>
                        <option value="leader">Leiter</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Hinzuf√ºgen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Rehearsal Modal -->
    <div id="createRehearsalModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="rehearsalModalTitle">Neuen Probetermin vorschlagen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="createRehearsalForm">
                <input type="hidden" id="editRehearsalId">
                <div class="form-group">
                    <label for="rehearsalBand">Band</label>
                    <select id="rehearsalBand" required>
                        <option value="">Band ausw√§hlen</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="rehearsalTitle">Titel</label>
                    <input type="text" id="rehearsalTitle" required>
                </div>
                <div class="form-group">
                    <label for="rehearsalLocation">Ort (Optional)</label>
                    <select id="rehearsalLocation">
                        <option value="">Kein Ort ausgew√§hlt</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="rehearsalDescription">Beschreibung</label>
                    <textarea id="rehearsalDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Terminvorschl√§ge</label>
                    <div id="dateProposals" class="date-proposals">
                        <div class="date-proposal-item">
                            <input type="datetime-local" class="date-input" required>
                            <button type="button" class="btn-icon remove-date" disabled>üóëÔ∏è</button>
                        </div>
                    </div>
                    <button type="button" id="addDateBtn" class="btn btn-secondary btn-sm">+ Weiteren Termin
                        hinzuf√ºgen</button>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="submit" class="btn btn-primary" id="saveRehearsalBtn">Vorschlag erstellen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Rehearsal Details Modal -->
    <div id="rehearsalDetailsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="rehearsalDetailsTitle"></h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="rehearsalDetailsContent"></div>
            </div>
        </div>
    </div>

    <!-- Confirm Rehearsal Modal -->
    <div id="confirmRehearsalModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Probe best√§tigen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="confirmRehearsalId">
                <input type="hidden" id="confirmDateIndex">

                <div class="section">
                    <h3>Ausgew√§hlter Termin</h3>
                    <p id="selectedDateTime" class="selected-date-display"></p>
                </div>

                <div class="section">
                    <h3>Probeort ausw√§hlen</h3>
                    <select id="confirmRehearsalLocation" class="form-select">
                        <option value="">Kein Ort ausgew√§hlt</option>
                    </select>
                </div>

                <div class="section">
                    <h3>Bandmitglieder benachrichtigen</h3>
                    <p class="help-text">W√§hle aus, welche Bandmitglieder eine Best√§tigungs-E-Mail erhalten sollen:</p>
                    <div id="confirmMembersList" class="confirm-members-list"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="button" id="sendConfirmationBtn" class="btn btn-primary">‚úÖ Probe best√§tigen & E-Mail
                        senden</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Event Modal -->
    <div id="createEventModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="eventModalTitle">Neuen Auftritt erstellen</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="createEventForm">
                <input type="hidden" id="editEventId">
                <div class="form-group">
                    <label for="eventBand">Band</label>
                    <select id="eventBand" required>
                        <option value="">Band ausw√§hlen</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="eventTitle">Titel</label>
                    <input type="text" id="eventTitle" required>
                </div>
                <div class="form-group">
                    <label for="eventDate">Datum und Uhrzeit</label>
                    <input type="datetime-local" id="eventDate" required>
                </div>
                <div class="form-group">
                    <label for="eventLocation">Ort</label>
                    <input type="text" id="eventLocation" required>
                </div>
                <div class="form-group">
                    <label for="eventInfo">Sonstige Infos zum Event</label>
                    <textarea id="eventInfo" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="eventTechInfo">Infos zur Technik</label>
                    <textarea id="eventTechInfo" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Bandmitglieder</label>
                    <div id="eventBandMembers" class="checkbox-list"></div>
                </div>
                <div class="form-group">
                    <label for="eventGuests">G√§ste (einer pro Zeile)</label>
                    <textarea id="eventGuests" rows="3" placeholder="Name des Gastes"></textarea>
                </div>
                <div class="form-group">
                    <label>Zugewiesene Probetermine</label>
                    <div id="eventRehearsals" class="checkbox-list"></div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="submit" class="btn btn-primary" id="saveEventBtn">Auftritt erstellen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Event Details Modal -->
    <div id="eventDetailsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="eventDetailsTitle"></h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="eventDetailsContent"></div>
            </div>
        </div>
    </div>

    <!-- Join Band Modal -->
    <div id="joinBandModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Band beitreten</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="joinBandForm">
                <div class="form-group">
                    <label for="joinBandCode">Band-Beitrittscode (8-stellig)</label>
                    <input type="text" id="joinBandCode" maxlength="8" pattern="[A-Za-z0-9]{8}" placeholder="XXXXXXXX"
                        required>
                    <small style="color: var(--color-text-secondary);">Frag deinen Bandleiter nach dem Code</small>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Abbrechen</button>
                    <button type="submit" class="btn btn-primary">Beitreten</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/email-service.js"></script>
    <script src="js/bands.js"></script>
    <script src="js/events.js"></script>
    <script src="js/rehearsals.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>

</html>